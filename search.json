[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "dynr Wiki",
    "section": "",
    "text": "This website serves as a Wiki for consolidating documentation, knowledge bases, and other relevant information pertaining to the dynr package. The intention is not to supplant existing sources of information, for example, https://CRAN.R-project.org/package=dynr and https://github.com/mhunter1/dynr, but to supplement them."
  },
  {
    "objectID": ".setup/quarto/intro/intro.html#description",
    "href": ".setup/quarto/intro/intro.html#description",
    "title": "dynr: Dynamic Models with Regime-Switching",
    "section": "Description",
    "text": "Description\nIntensive longitudinal data have become increasingly prevalent in various scientific disciplines. Many such data sets are noisy, multivariate, and multi-subject in nature. The change functions may also be continuous, or continuous but interspersed with periods of discontinuities (i.e., showing regime switches). The package dynr (Dynamic Modeling in R) is an R package that implements a set of computationally efficient algorithms for handling a broad class of linear and nonlinear discrete- and continuous- time models with regime-switching properties under the constraint of linear Gaussian measurement functions. The discrete-time models can generally take on the form of a state-space or difference equation model. The continuous-time models are generally expressed as a set of ordinary or stochastic differential equations. All estimation and computations are performed in C, but users are provided with the option to specify the model of interest via a set of simple and easy-to-learn model specification functions in R. Model fitting can be performed using single-subject time series data or multiple-subject longitudinal data. Ou et al. (2019) provided a detailed introduction to the interface and more information on the algorithms."
  },
  {
    "objectID": ".setup/quarto/intro/intro.html#cran",
    "href": ".setup/quarto/intro/intro.html#cran",
    "title": "dynr: Dynamic Models with Regime-Switching",
    "section": "CRAN",
    "text": "CRAN\nThe Comprehensive R Archive Network (CRAN) release of the dynr package is available at https://CRAN.R-project.org/package=dynr."
  },
  {
    "objectID": ".setup/quarto/intro/intro.html#github",
    "href": ".setup/quarto/intro/intro.html#github",
    "title": "dynr: Dynamic Models with Regime-Switching",
    "section": "GitHub",
    "text": "GitHub\nThe development version of the dynr package is available at https://github.com/mhunter1/dynr.\n\n\n\n\nOu, L., Hunter, M. D., & Chow, S.-M. (2019). What’s for dynr: A package for linear and nonlinear dynamic modeling in R. The R Journal, 11(1), 91. https://doi.org/10.32614/rj-2019-012"
  },
  {
    "objectID": ".setup/quarto/docker/docker.html",
    "href": ".setup/quarto/docker/docker.html",
    "title": "dynr Docker Container",
    "section": "",
    "text": "In order to facilitate the use of the dynr package, we have created an Rstudio Server Docker container based on the Rocker Project (Boettiger & Eddelbuettel, 2017; Nüst et al., 2020), with the dynr package pre-installed.\n\nWindows using WSL 2\nmacOS\nDocker Images, Containers, and Tags\nDocker Volumes\n\n\n\n\n\nBoettiger, C., & Eddelbuettel, D. (2017). An introduction to Rocker: Docker containers for R. The R Journal, 9(2), 527. https://doi.org/10.32614/rj-2017-065\n\n\nNüst, D., Eddelbuettel, D., Bennett, D., Cannoodt, R., Clark, D., Dar’oczi, G., Edmondson, M., Fay, C., Hughes, E., Kjeldgaard, L., Lopp, S., Marwick, B., Nolis, H., Nolis, J., Ooi, H., Ram, K., Ross, N., Shepherd, L., S’olymos, P., … Xiao, N. (2020). The Rockerverse: Packages and applications for containerisation with R. The R Journal, 12(1), 437. https://doi.org/10.32614/rj-2020-007"
  },
  {
    "objectID": ".setup/quarto/docker/docker-win.html#installation-video-tutorial",
    "href": ".setup/quarto/docker/docker-win.html#installation-video-tutorial",
    "title": "Windows using WSL 2",
    "section": "Installation Video Tutorial",
    "text": "Installation Video Tutorial\nClick here for a video tutorial of the installation process."
  },
  {
    "objectID": ".setup/quarto/docker/docker-win.html#installing-windows-subsystem-for-linux-wsl",
    "href": ".setup/quarto/docker/docker-win.html#installing-windows-subsystem-for-linux-wsl",
    "title": "Windows using WSL 2",
    "section": "Installing Windows Subsystem for Linux (WSL)",
    "text": "Installing Windows Subsystem for Linux (WSL)\n\nSearch for PowerShell or Command Prompt. Right click to run as an administrator, then type the following:\n\nwsl --install --distribution Ubuntu\n\n\n\n\n\n\n\nNote\n\n\n\nThere are times when the operating system requires a restart. After restarting, when the installation is successful, a new application Ubuntu will be available. Launch this application to continue.\n\n\n\nWhen prompted:\n\nEnter new UNIX username:\nNew password:\nRetype new password:\n\nYou should see a prompt similar to the following which indicates that you are inside the newly installed Ubuntu instance. In the prompt, type exit to exit Ubuntu.\n\nUSER@HOST:~$\n\nYou might need to update the kernel. You can do this with the following:\n\nDownload the Linux kernel update package from https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi\nDouble-click wsl_update_x64.msi to update the kernel.\n\nA system restart might be a good idea for all the changes to take effect.\n\nIf the above instructions fail, you might be using an older version of Windows. See https://learn.microsoft.com/en-us/windows/wsl/install-manual for more details on how to manually install WSL."
  },
  {
    "objectID": ".setup/quarto/docker/docker-win.html#installing-docker-desktop",
    "href": ".setup/quarto/docker/docker-win.html#installing-docker-desktop",
    "title": "Windows using WSL 2",
    "section": "Installing Docker Desktop",
    "text": "Installing Docker Desktop\n\nDownload the the appropriate Docker Desktop for Windows from https://www.docker.com/products/docker-desktop/.\nDouble-click Docker Desktop Installer.exe to install Docker Desktop.\nLaunch Docker Desktop.\n\nClick the Accept button to accept the terms of service to continue.\nYou may continue without creating an account or signing in."
  },
  {
    "objectID": ".setup/quarto/docker/docker-win.html#running-the-dynr-docker-container",
    "href": ".setup/quarto/docker/docker-win.html#running-the-dynr-docker-container",
    "title": "Windows using WSL 2",
    "section": "Running the dynr Docker Container",
    "text": "Running the dynr Docker Container\n\nLaunch Docker Desktop.\nIn PowerShell, type the following to pull the latest Docker image:\n\ndocker pull jeksterslab/dynr-rocker:latest\n\nIn PowerShell, type the following to launch Rstudio Server1:\n\ndocker run --rm -ti -e PASSWORD=yourpassword -p 127.0.0.1:8787:8787 jeksterslab/dynr-rocker\n\nOpen http://localhost:8787 on your web browser to launch Rstudio Server.\n\nusername: rstudio\npassword: yourpassword2"
  },
  {
    "objectID": ".setup/quarto/docker/docker-win.html#footnotes",
    "href": ".setup/quarto/docker/docker-win.html#footnotes",
    "title": "Windows using WSL 2",
    "section": "",
    "text": "Note for developers only: Replace jeksterslab/dynr-rocker with jeksterslab/dynr-arma-rocker to use the arma branch.↩︎\nYou can change the password by replacing yourpassword in PASSWORD=yourpassword.↩︎"
  },
  {
    "objectID": ".setup/quarto/docker/docker-mac.html#installation-video-tutorial",
    "href": ".setup/quarto/docker/docker-mac.html#installation-video-tutorial",
    "title": "macOS",
    "section": "Installation Video Tutorial",
    "text": "Installation Video Tutorial\nClick here for a video tutorial of the installation process."
  },
  {
    "objectID": ".setup/quarto/docker/docker-mac.html#installing-docker-desktop",
    "href": ".setup/quarto/docker/docker-mac.html#installing-docker-desktop",
    "title": "macOS",
    "section": "Installing Docker Desktop",
    "text": "Installing Docker Desktop\n\n\nDownload the the appropriate Docker Desktop for macOS (Intel Chip vs. Apple Chip) from https://www.docker.com/products/docker-desktop/.\nDouble-click Desktop.dmg to install Docker Desktop.\nDrag Docker.app to the Applications folder.\nLaunch Docker from the Launchpad.\n\nChoose Use recommended settings (requires password) and provide your macOS user password.\nClick the Accept button to accept the terms of service to continue.\nYou may continue without creating an account or signing in."
  },
  {
    "objectID": ".setup/quarto/docker/docker-mac.html#running-the-dynr-docker-container",
    "href": ".setup/quarto/docker/docker-mac.html#running-the-dynr-docker-container",
    "title": "macOS",
    "section": "Running the dynr Docker Container",
    "text": "Running the dynr Docker Container\n\nLaunch Docker Desktop.\nOn your macOS terminal, type the following to pull the latest Docker image:\n\ndocker pull jeksterslab/dynr-rocker:latest\n\nOn your macOS terminal, type the following to launch Rstudio Server1:\n\ndocker run --rm -ti -e PASSWORD=yourpassword -p 127.0.0.1:8787:8787 jeksterslab/dynr-rocker\n\nOpen http://localhost:8787 on your web browser to launch Rstudio Server.\n\nusername: rstudio\npassword: yourpassword2"
  },
  {
    "objectID": ".setup/quarto/docker/docker-mac.html#footnotes",
    "href": ".setup/quarto/docker/docker-mac.html#footnotes",
    "title": "macOS",
    "section": "",
    "text": "Note for developers only: Replace jeksterslab/dynr-rocker with jeksterslab/dynr-arma-rocker to use the arma branch.↩︎\nYou can change the password by replacing yourpassword in PASSWORD=yourpassword.↩︎"
  },
  {
    "objectID": ".setup/quarto/docker/docker-image-container-tag.html#footnotes",
    "href": ".setup/quarto/docker/docker-image-container-tag.html#footnotes",
    "title": "Docker Images, Containers, and Tags",
    "section": "",
    "text": "Docker Hub is the remote repository of the dynr Docker images. A Docker Hub account is not required to use the dynr Docker images in Docker Hub. However, an account is required to view details of the dynr docker images.↩︎"
  },
  {
    "objectID": ".setup/quarto/docker/docker-volumes.html",
    "href": ".setup/quarto/docker/docker-volumes.html",
    "title": "Docker Volumes",
    "section": "",
    "text": "By default files created inside the Docker container does not persist when the container is stopped. We can mount a persistent volume on your Docker container using the -v flag. The idea here is that Docker maps a volume of the local host machine to a volume inside the Docker container. Let’s say we have a folder dynr_project inside the local Documents folder. We can mount that volume using the following for Windows\ndocker run -v C:\\Users\\user\\Documents\\dynr_project:/home/rstudio/working-dir --rm -ti -e PASSWORD=yourpassword -p 127.0.0.1:8787:8787 jeksterslab/dynr-rocker\nand for mac\ndocker run -v /Users/username/Documents/dynr_project:/home/rstudio/working-dir --rm -ti -e PASSWORD=yourpassword -p 127.0.0.1:8787:8787 jeksterslab/dynr-rocker\nThe directory on the left size of the colon is an existing directory on the host machine that the current user has read and write access to. The directory on the right side of the colon is the default working directory inside the Docker container. If you make changes inside the Docker container on files inside /home/rstudio/working-dir, the changes will persist on the mounted dynr_project folder. If you make changes in the dynr_project folder, they will be reflected on /home/rstudio/working-dir of the currently running container."
  },
  {
    "objectID": ".setup/quarto/examples/lin-growth.html#model",
    "href": ".setup/quarto/examples/lin-growth.html#model",
    "title": "The Linear Growth Curve Model",
    "section": "Model",
    "text": "Model\nThe measurement model is given by \\[\\begin{equation}\n  y_{i, t}\n  =\n  \\left(\n  \\begin{array}{cc}\n    1 & 0 \\\\\n  \\end{array}\n  \\right)\n  \\left(\n  \\begin{array}{c}\n    \\eta_{0_{i, t}} \\\\\n    \\eta_{1_{i, t}} \\\\\n  \\end{array}\n  \\right)\n  +\n  \\boldsymbol{\\varepsilon}_{i, t}\n  \\quad\n  \\mathrm{with}\n  \\quad\n  \\boldsymbol{\\varepsilon}_{i, t}\n  \\sim\n  \\mathcal{N}\n  \\left(\n  0,\n  \\theta\n  \\right)\n\\end{equation}\\] where \\(y_{i, t}\\), \\(\\eta_{0_{i, t}}\\), \\(\\eta_{1_{i, t}}\\), and \\(\\boldsymbol{\\varepsilon}_{i, t}\\) are random variables and \\(\\theta\\) is a model parameter. \\(y_{i, t}\\) is a vector of observed random variables at time \\(t\\) and individual \\(i\\), \\(\\eta_{0_{i, t}}\\) (intercept) and \\(\\eta_{1_{i, t}}\\) (slope) form a vector of latent random variables at time \\(t\\) and individual \\(i\\), and \\(\\boldsymbol{\\varepsilon}_{i, t}\\) is a vector of random measurement errors at time \\(t\\) and individual \\(i\\). \\(\\theta\\) is the variance of \\(\\boldsymbol{\\varepsilon}\\).\nThe dynamic structure is given by \\[\\begin{equation}\n  \\left(\n  \\begin{array}{c}\n  \\eta_{0_{i, t}} \\\\\n  \\eta_{1_{i, t}} \\\\\n  \\end{array}\n  \\right)\n  =\n  \\left(\n  \\begin{array}{cc}\n    1 & 1 \\\\\n    0 & 1 \\\\\n  \\end{array}\n  \\right)\n  \\left(\n  \\begin{array}{c}\n  \\eta_{0_{i, t - 1}} \\\\\n  \\eta_{1_{i, t - 1}} \\\\\n  \\end{array}\n  \\right) .\n\\end{equation}\\]\nThe mean vector and covariance matrix of the intercept and slope are captured in the mean vector and covariance matrix of the initial condition given by \\[\\begin{equation}\n  \\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}\n  =\n  \\left(\n  \\begin{array}{c}\n    \\mu_{\\eta_{0}} \\\\\n    \\mu_{\\eta_{1}} \\\\\n  \\end{array}\n  \\right) \\quad \\mathrm{and,}\n\\end{equation}\\]\n\\[\\begin{equation}\n  \\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0}\n  =\n  \\left(\n  \\begin{array}{cc}\n    \\sigma^{2}_{\\eta_{0}} &\n    \\sigma_{\\eta_{0}, \\eta_{1}} \\\\\n    \\sigma_{\\eta_{1}, \\eta_{0}} &\n    \\sigma^{2}_{\\eta_{1}} \\\\\n  \\end{array}\n  \\right) .\n\\end{equation}\\]"
  },
  {
    "objectID": ".setup/quarto/examples/lin-growth.html#data-generation",
    "href": ".setup/quarto/examples/lin-growth.html#data-generation",
    "title": "The Linear Growth Curve Model",
    "section": "Data Generation",
    "text": "Data Generation\n\nNotation\nLet \\(t = 5\\) be the number of time points and \\(n = 1000\\) be the number of individuals.\nLet the measurement error variance \\(\\theta\\) be given by\n\\[\\begin{equation}\n\\theta\n=\n0.6 .\n\\end{equation}\\]\nLet the initial condition \\(\\boldsymbol{\\eta}_{0}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\eta}_{0}\n\\sim\n\\mathcal{N}\n\\left(\n\\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0},\n\\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0}\n\\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{c}\n  0.615 \\\\\n  1.006 \\\\\n\\end{array}\n\\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{ccc}\n  1.932 & 0.618 \\\\\n  0.618 & 0.587 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\n\n\nR Function Arguments\n\nn\n\n[1] 1000\n\ntime\n\n[1] 5\n\nmu0\n\n[1] 0.615 1.006\n\nsigma0\n\n      [,1]  [,2]\n[1,] 1.932 0.618\n[2,] 0.618 0.587\n\ntheta\n\n[1] 0.6\n\n\n\n\nUsing the SimSSMLinGrowth Function from the simStateSpace Package to Simulate Data\n\nlibrary(simStateSpace)\nsim &lt;- SimSSMLinGrowth(\n  n = n,\n  mu0 = mu0,\n  sigma0 = sigma0,\n  theta = theta,\n  type = 0,\n  time = time\n)\ndata &lt;- as.data.frame(sim)\nhead(data)\n\n  id time       y1\n1  1    0 1.970296\n2  1    1 1.821956\n3  1    2 4.414843\n4  1    3 7.455151\n5  1    4 8.220113\n6  2    0 1.062328\n\nplot(sim)"
  },
  {
    "objectID": ".setup/quarto/examples/lin-growth.html#model-fitting",
    "href": ".setup/quarto/examples/lin-growth.html#model-fitting",
    "title": "The Linear Growth Curve Model",
    "section": "Model Fitting",
    "text": "Model Fitting\n\nPrepare Data\n\ndynr_data &lt;- dynr::dynr.data(\n  dataframe = data,\n  id = \"id\",\n  time = \"time\",\n  observed = \"y1\"\n)\n\n\n\nPrepare Initial Condition\n\ndynr_initial &lt;- dynr::prep.initial(\n  values.inistate = mu0,\n  params.inistate = c(\"mu0_0\", \"mu0_1\"),\n  values.inicov = sigma0,\n  params.inicov = matrix(\n    data = c(\n      \"sigma0_00\", \"sigma0_01\",\n      \"sigma0_01\", \"sigma0_11\"\n    ),\n    nrow = 2\n  )\n)\n\n\n\nPrepare Measurement Model\n\ndynr_measurement &lt;- dynr::prep.measurement(\n  values.load = matrix(data = c(1, 0), nrow = 1),\n  params.load = matrix(data = \"fixed\", nrow = 1, ncol = 2),\n  state.names = c(\"eta_0\", \"eta_1\"),\n  obs.names = \"y1\"\n)\n\n\n\nPrepare Dynamic Process\n\ndynr_dynamics &lt;- dynr::prep.formulaDynamics(\n  formula = list(\n    eta_0 ~ eta_0 + eta_1,\n    eta_1 ~ eta_1\n  ),\n  isContinuousTime = FALSE\n)\n\nWarning in dynr::prep.formulaDynamics(formula = list(eta_0 ~ eta_0 + eta_1, :\nYou provided no start values: length(startval)==0. If you have no free\nparameters, keep calm and carry on.\n\n\n\n\nPrepare Process Noise\n\ndynr_noise &lt;- dynr::prep.noise(\n  values.latent = matrix(data = 0, nrow = 2, ncol = 2),\n  params.latent = matrix(data = \"fixed\", nrow = 2, ncol = 2),\n  values.observed = theta,\n  params.observed = \"theta\"\n)\n\n\n\nPrepare the Model\n\nmodel &lt;- dynr::dynr.model(\n  data = dynr_data,\n  initial = dynr_initial,\n  measurement = dynr_measurement,\n  dynamics = dynr_dynamics,\n  noise = dynr_noise,\n  outfile = \"lin-growth.c\"\n)\n\n\n\n\n\n\n\n\nFit the Model\n\nresults &lt;- dynr::dynr.cook(\n  model,\n  debug_flag = TRUE,\n  verbose = FALSE\n)\n\n[1] \"Get ready!!!!\"\nusing C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’\nOptimization function called.\nStarting Hessian calculation ...\nFinished Hessian calculation.\nOriginal exit flag:  3 \nModified exit flag:  3 \nOptimization terminated successfully: ftol_rel or ftol_abs was reached. \nOriginal fitted parameters:  -0.4945857 0.617213 0.9971604 0.6201962 0.3298718 \n-0.9171075 \n\nTransformed fitted parameters:  0.6098235 0.617213 0.9971604 1.859293 0.6133282 \n0.6019931 \n\nDoing end processing\nSuccessful trial\nTotal Time: 4.834388 \nBackend Time: 4.417626"
  },
  {
    "objectID": ".setup/quarto/examples/lin-growth.html#summary",
    "href": ".setup/quarto/examples/lin-growth.html#summary",
    "title": "The Linear Growth Curve Model",
    "section": "Summary",
    "text": "Summary\n\nsummary(results)\n\nCoefficients:\n          Estimate Std. Error t value ci.lower ci.upper Pr(&gt;|t|)    \ntheta      0.60982    0.01575   38.73  0.57896  0.64069   &lt;2e-16 ***\nmu0_0      0.61721    0.04717   13.08  0.52475  0.70967   &lt;2e-16 ***\nmu0_1      0.99716    0.02575   38.73  0.94670  1.04762   &lt;2e-16 ***\nsigma0_00  1.85929    0.09996   18.60  1.66338  2.05520   &lt;2e-16 ***\nsigma0_01  0.61333    0.04156   14.76  0.53188  0.69478   &lt;2e-16 ***\nsigma0_11  0.60199    0.02969   20.27  0.54379  0.66019   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n-2 log-likelihood value at convergence = 16827.97\nAIC = 16839.97\nBIC = 16879.08\n\n\n\n\n[1] 0.6172130 0.9971604\n\n\n\nEstimated Parameters\n\nmu0_hat\n\n[1] 0.6172130 0.9971604\n\nsigma0_hat\n\n          [,1]      [,2]\n[1,] 1.8592928 0.6133282\n[2,] 0.6133282 0.6019931\n\ntheta_hat\n\n    theta \n0.6098235"
  },
  {
    "objectID": ".setup/quarto/examples/lin-growth.html#linear-growth-curve-model-in-structural-equation-modeling",
    "href": ".setup/quarto/examples/lin-growth.html#linear-growth-curve-model-in-structural-equation-modeling",
    "title": "The Linear Growth Curve Model",
    "section": "Linear Growth Curve Model in Structural Equation Modeling",
    "text": "Linear Growth Curve Model in Structural Equation Modeling\n\nWide Data Set\n\ndata &lt;- as.data.frame(sim, long = FALSE)\nhead(data)\n\n  id      y1_0      y1_1     y1_2     y1_3     y1_4\n1  1 1.9702957 1.8219557 4.414843 7.455151 8.220113\n2  2 1.0623281 3.5056952 4.132857 5.343676 7.976648\n3  3 3.0372654 4.9566830 6.901524 7.290094 9.642927\n4  4 0.9393614 2.4163546 3.042043 4.496167 6.223807\n5  5 0.3220574 0.2134775 1.887796 2.343611 3.095962\n6  6 2.1946621 3.7583552 5.156733 5.635134 6.456176\n\n\n\n\nModel\n\nmodel &lt;- \"\n  # factor loadings\n  eta0 =~ 1 * y1_0 + 1 * y1_1 + 1 * y1_2 + 1 * y1_3 + 1 * y1_4\n  eta1 =~ 0 * y1_0 + 1 * y1_1 + 2 * y1_2 + 3 * y1_3 + 4 * y1_4\n  # means of latent variables\n  eta0 ~ mu0 * 1\n  eta1 ~ mu1 * 1\n  # variances and covariances of latent variables\n  eta0 ~~ sigma00 * eta0\n  eta0 ~~ sigma01 * eta1\n  eta1 ~~ sigma11 * eta1\n  # constrain error variance theta to be equal\n  y1_0 ~~ theta * y1_0\n  y1_1 ~~ theta * y1_1\n  y1_2 ~~ theta * y1_2\n  y1_3 ~~ theta * y1_3\n  y1_4 ~~ theta * y1_4\n\"\n\n\nfit &lt;- lavaan::growth(\n  model = model,\n  data = data\n)\nlavaan::summary(fit)\n\nlavaan 0.6.17 ended normally after 31 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        10\n  Number of equality constraints                     4\n\n  Number of observations                          1000\n\nModel Test User Model:\n                                                      \n  Test statistic                                14.831\n  Degrees of freedom                                14\n  P-value (Chi-square)                           0.390\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  eta0 =~                                             \n    y1_0              1.000                           \n    y1_1              1.000                           \n    y1_2              1.000                           \n    y1_3              1.000                           \n    y1_4              1.000                           \n  eta1 =~                                             \n    y1_0              0.000                           \n    y1_1              1.000                           \n    y1_2              2.000                           \n    y1_3              3.000                           \n    y1_4              4.000                           \n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  eta0 ~~                                             \n    eta1    (sg01)    0.613    0.042   14.762    0.000\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n    eta0     (mu0)    0.617    0.047   13.086    0.000\n    eta1     (mu1)    0.997    0.026   38.728    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n    eta0    (sg00)    1.859    0.100   18.600    0.000\n    eta1    (sg11)    0.602    0.030   20.275    0.000\n   .y1_0    (thet)    0.610    0.016   38.730    0.000\n   .y1_1    (thet)    0.610    0.016   38.730    0.000\n   .y1_2    (thet)    0.610    0.016   38.730    0.000\n   .y1_3    (thet)    0.610    0.016   38.730    0.000\n   .y1_4    (thet)    0.610    0.016   38.730    0.000"
  },
  {
    "objectID": ".setup/quarto/examples/var.html#model",
    "href": ".setup/quarto/examples/var.html#model",
    "title": "The Vector Autoregressive Model",
    "section": "Model",
    "text": "Model\nThe measurement model is given by\n\\[\\begin{equation}\n  \\mathbf{y}_{i, t}\n  =\n  \\boldsymbol{\\eta}_{i, t} .\n\\end{equation}\\]\nThe dynamic structure is given by\n\\[\\begin{equation}\n  \\boldsymbol{\\eta}_{i, t}\n  =\n  \\boldsymbol{\\alpha}\n  +\n  \\boldsymbol{\\beta}\n  \\boldsymbol{\\eta}_{i, t - 1}\n  +\n  \\boldsymbol{\\zeta}_{i, t}\n  \\quad\n  \\mathrm{with}\n  \\quad\n  \\boldsymbol{\\zeta}_{i, t}\n  \\sim\n  \\mathcal{N}\n  \\left(\n  \\mathbf{0},\n  \\boldsymbol{\\Psi}\n  \\right)\n\\end{equation}\\]\nwhere \\(\\boldsymbol{\\eta}_{i, t}\\), \\(\\boldsymbol{\\eta}_{i, t - 1}\\), and \\(\\boldsymbol{\\zeta}_{i, t}\\) are random variables and \\(\\boldsymbol{\\alpha}\\), \\(\\boldsymbol{\\beta}\\), and \\(\\boldsymbol{\\Psi}\\) are model parameters. \\(\\boldsymbol{\\eta}_{i, t}\\) is a vector of latent variables at time \\(t\\) and individual \\(i\\), \\(\\boldsymbol{\\eta}_{i, t - 1}\\) is a vector of latent variables at \\(t - 1\\) and individual \\(i\\), and \\(\\boldsymbol{\\zeta}_{i, t}\\) is a vector of dynamic noise at time \\(t\\) and individual \\(i\\), while \\(\\boldsymbol{\\alpha}\\) is a vector of intercepts, \\(\\boldsymbol{\\beta}\\) is a matrix of autoregression and cross regression coefficients, and \\(\\boldsymbol{\\Psi}\\) is the covariance matrix of \\(\\boldsymbol{\\zeta}_{i, t}\\)."
  },
  {
    "objectID": ".setup/quarto/examples/var.html#data-generation",
    "href": ".setup/quarto/examples/var.html#data-generation",
    "title": "The Vector Autoregressive Model",
    "section": "Data Generation",
    "text": "Data Generation\n\nNotation\nLet \\(t = 1000\\) be the number of time points and \\(n = 5\\) be the number of individuals.\nLet the initial condition \\(\\boldsymbol{\\eta}_{0}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\eta}_{0} \\sim \\mathcal{N} \\left( \\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}, \\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0} \\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{c}\n  0 \\\\\n  0 \\\\\n  0 \\\\\n\\end{array}\n\\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{ccc}\n  1 & 0 & 0 \\\\\n  0 & 1 & 0 \\\\\n  0 & 0 & 1 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the constant vector \\(\\boldsymbol{\\alpha}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\alpha}\n=\n\\left(\n\\begin{array}{c}\n  0 \\\\\n  0 \\\\\n  0 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the transition matrix \\(\\boldsymbol{\\beta}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\beta}\n=\n\\left(\n\\begin{array}{ccc}\n  0.7 & 0 & 0 \\\\\n  0.5 & 0.6 & 0 \\\\\n  -0.1 & 0.4 & 0.5 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the dynamic process noise \\(\\boldsymbol{\\Psi}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\Psi}\n=\n\\left(\n\\begin{array}{ccc}\n  1 & 0 & 0 \\\\\n  0 & 1 & 0 \\\\\n  0 & 0 & 1 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\n\n\nR Function Arguments\n\nn\n\n[1] 5\n\ntime\n\n[1] 1000\n\nmu0\n\n[1] 0 0 0\n\nsigma0\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\nalpha\n\n[1] 0 0 0\n\nbeta\n\n     [,1] [,2] [,3]\n[1,]  0.7  0.0  0.0\n[2,]  0.5  0.6  0.0\n[3,] -0.1  0.4  0.5\n\npsi\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\n\n\n\nUsing the SimSSMVARFixed Function from the simStateSpace Package to Simulate Data\n\nlibrary(simStateSpace)\nsim &lt;- SimSSMVARFixed(\n  n = n,\n  mu0 = mu0,\n  sigma0 = sigma0,\n  alpha = alpha,\n  beta = beta,\n  psi = psi,\n  time = time,\n  burn_in = 0\n)\ndata &lt;- as.data.frame(sim)\nhead(data)\n\n  id time          y1         y2        y3\n1  1    0 -0.53150173  0.8212527 2.2174497\n2  1    1  0.03280741 -0.3981712 2.4785526\n3  1    2 -0.31722163  1.5413967 1.1638121\n4  1    3 -0.28222201  1.4683295 0.1377762\n5  1    4 -1.04463827  0.7687173 0.4667933\n6  1    5 -0.92475541  1.1649958 1.2460595\n\nplot(sim)"
  },
  {
    "objectID": ".setup/quarto/examples/var.html#model-fitting",
    "href": ".setup/quarto/examples/var.html#model-fitting",
    "title": "The Vector Autoregressive Model",
    "section": "Model Fitting",
    "text": "Model Fitting\n\nPrepare Data\n\ndynr_data &lt;- dynr::dynr.data(\n  data = data,\n  id = \"id\",\n  time = \"time\",\n  observed = c(\"y1\", \"y2\", \"y3\")\n)\n\n\n\nPrepare Initial Condition\n\ndynr_initial &lt;- dynr::prep.initial(\n  values.inistate = mu0,\n  params.inistate = c(\"mu0_1\", \"mu0_2\", \"mu0_3\"),\n  values.inicov = sigma0,\n  params.inicov = matrix(\n    data = c(\n      \"sigma0_11\", \"sigma0_12\", \"sigma0_13\",\n      \"sigma0_12\", \"sigma0_22\", \"sigma0_23\",\n      \"sigma0_13\", \"sigma0_23\", \"sigma0_33\"\n    ),\n    nrow = 3\n  )\n)\n\n\n\nPrepare Measurement Model\n\ndynr_measurement &lt;- dynr::prep.measurement(\n  values.load = diag(3),\n  params.load = matrix(data = \"fixed\", nrow = 3, ncol = 3),\n  state.names = c(\"eta_1\", \"eta_2\", \"eta_3\"),\n  obs.names = c(\"y1\", \"y2\", \"y3\")\n)\n\n\n\nPrepare Dynamic Process\n\ndynr_dynamics &lt;- dynr::prep.formulaDynamics(\n  formula = list(\n    eta_1 ~ alpha_1 * 1 + beta_11 * eta_1 + beta_12 * eta_2 + beta_13 * eta_3,\n    eta_2 ~ alpha_2 * 1 + beta_21 * eta_1 + beta_22 * eta_2 + beta_23 * eta_3,\n    eta_3 ~ alpha_3 * 1 + beta_31 * eta_1 + beta_32 * eta_2 + beta_33 * eta_3\n  ),\n  startval = c(\n    alpha_1 = alpha[1], alpha_2 = alpha[2], alpha_3 = alpha[3],\n    beta_11 = beta[1, 1], beta_12 = beta[1, 2], beta_13 = beta[1, 3],\n    beta_21 = beta[2, 1], beta_22 = beta[2, 2], beta_23 = beta[2, 3],\n    beta_31 = beta[3, 1], beta_32 = beta[3, 2], beta_33 = beta[3, 3]\n  ),\n  isContinuousTime = FALSE\n)\n\n\n\nPrepare Process Noise\n\ndynr_noise &lt;- dynr::prep.noise(\n  values.latent = psi,\n  params.latent = matrix(\n    data = c(\n      \"psi_11\", \"psi_12\", \"psi_13\",\n      \"psi_12\", \"psi_22\", \"psi_23\",\n      \"psi_13\", \"psi_23\", \"psi_33\"\n    ),\n    nrow = 3\n  ),\n  values.observed = matrix(data = 0, nrow = 3, ncol = 3),\n  params.observed = matrix(data = \"fixed\", nrow = 3, ncol = 3)\n)\n\n\n\nPrepare the Model\n\nmodel &lt;- dynr::dynr.model(\n  data = dynr_data,\n  initial = dynr_initial,\n  measurement = dynr_measurement,\n  dynamics = dynr_dynamics,\n  noise = dynr_noise,\n  outfile = \"var.c\"\n)\n\n\n\n\n\n\n\n\nFit the Model\n\nresults &lt;- dynr::dynr.cook(\n  model,\n  debug_flag = TRUE,\n  verbose = FALSE\n)\n\n[1] \"Get ready!!!!\"\nusing C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’\nOptimization function called.\nStarting Hessian calculation ...\nFinished Hessian calculation.\nOriginal exit flag:  3 \nModified exit flag:  3 \nOptimization terminated successfully: ftol_rel or ftol_abs was reached. \nOriginal fitted parameters:  -0.01436224 -0.008084834 0.008022517 0.6906 \n0.01492941 -0.00319284 0.486072 0.6206747 -0.007399144 -0.113037 0.4161175 \n0.4941164 -0.01756573 -0.02341745 -0.01479442 0.007374806 -0.01464243 \n-0.003880536 -0.525563 -0.2592167 0.8204044 -0.1864839 -0.7714447 0.3367576 \n-0.4211325 -0.02244622 -0.0987352 \n\nTransformed fitted parameters:  -0.01436224 -0.008084834 0.008022517 0.6906 \n0.01492941 -0.00319284 0.486072 0.6206747 -0.007399144 -0.113037 0.4161175 \n0.4941164 0.9825876 -0.02300969 -0.01453682 1.007941 -0.01441039 0.996558 \n-0.525563 -0.2592167 0.8204044 0.829872 -0.6402003 0.2794657 1.150182 \n-0.2303239 1.000425 \n\nDoing end processing\nSuccessful trial\nTotal Time: 2.026176 \nBackend Time: 2.018748"
  },
  {
    "objectID": ".setup/quarto/examples/var.html#summary",
    "href": ".setup/quarto/examples/var.html#summary",
    "title": "The Vector Autoregressive Model",
    "section": "Summary",
    "text": "Summary\n\nsummary(results)\n\nCoefficients:\n           Estimate Std. Error t value  ci.lower  ci.upper Pr(&gt;|t|)    \nalpha_1   -0.014362   0.014043  -1.023 -0.041886  0.013161   0.1532    \nalpha_2   -0.008085   0.014222  -0.568 -0.035960  0.019790   0.2849    \nalpha_3    0.008023   0.014141   0.567 -0.019694  0.035739   0.2853    \nbeta_11    0.690600   0.011350  60.845  0.668354  0.712846   &lt;2e-16 ***\nbeta_12    0.014929   0.009421   1.585 -0.003536  0.033394   0.0566 .  \nbeta_13   -0.003193   0.009597  -0.333 -0.022002  0.015616   0.3697    \nbeta_21    0.486072   0.011496  42.281  0.463540  0.508604   &lt;2e-16 ***\nbeta_22    0.620675   0.009541  65.051  0.601974  0.639375   &lt;2e-16 ***\nbeta_23   -0.007399   0.009719  -0.761 -0.026447  0.011649   0.2232    \nbeta_31   -0.113037   0.011431  -9.889 -0.135441 -0.090633   &lt;2e-16 ***\nbeta_32    0.416117   0.009488  43.855  0.397520  0.434715   &lt;2e-16 ***\nbeta_33    0.494116   0.009664  51.127  0.475174  0.513058   &lt;2e-16 ***\npsi_11     0.982588   0.019656  49.990  0.944063  1.021112   &lt;2e-16 ***\npsi_12    -0.023010   0.014082  -1.634 -0.050611  0.004591   0.0512 .  \npsi_13    -0.014537   0.014000  -1.038 -0.041976  0.012903   0.1496    \npsi_22     1.007941   0.020166  49.983  0.968417  1.047465   &lt;2e-16 ***\npsi_23    -0.014410   0.014178  -1.016 -0.042198  0.013378   0.1547    \npsi_33     0.996558   0.019936  49.988  0.957484  1.035632   &lt;2e-16 ***\nmu0_1     -0.525563   0.403929  -1.301 -1.317249  0.266123   0.0966 .  \nmu0_2     -0.259217   0.474378  -0.546 -1.188980  0.670547   0.2924    \nmu0_3      0.820404   0.445352   1.842 -0.052470  1.693278   0.0328 *  \nsigma0_11  0.829872   0.522970   1.587 -0.195131  1.854875   0.0563 .  \nsigma0_12 -0.640200   0.522709  -1.225 -1.664691  0.384290   0.1104    \nsigma0_13  0.279466   0.426654   0.655 -0.556761  1.115692   0.2562    \nsigma0_22  1.150182   0.730425   1.575 -0.281424  2.581789   0.0577 .  \nsigma0_23 -0.230324   0.485827  -0.474 -1.182527  0.721880   0.3177    \nsigma0_33  1.000425   0.636307   1.572 -0.246714  2.247565   0.0580 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n-2 log-likelihood value at convergence = 42495.14\nAIC = 42549.14\nBIC = 42725.11\n\n\n\nParameter Estimates\n\nalpha_hat\n\n[1] -0.014362239 -0.008084834  0.008022517\n\nbeta_hat\n\n          [,1]       [,2]         [,3]\n[1,]  0.690600 0.01492941 -0.003192840\n[2,]  0.486072 0.62067474 -0.007399144\n[3,] -0.113037 0.41611746  0.494116356\n\npsi_hat\n\n            [,1]        [,2]        [,3]\n[1,]  0.98258765 -0.02300969 -0.01453682\n[2,] -0.02300969  1.00794089 -0.01441039\n[3,] -0.01453682 -0.01441039  0.99655804"
  },
  {
    "objectID": ".setup/quarto/examples/ou.html#model",
    "href": ".setup/quarto/examples/ou.html#model",
    "title": "The Ornstein–Uhlenbeck Model",
    "section": "Model",
    "text": "Model\nThe measurement model is given by\n\\[\\begin{equation}\n  \\mathbf{y}_{i, t}\n  =\n  \\boldsymbol{\\nu}\n  +\n  \\boldsymbol{\\Lambda}\n  \\boldsymbol{\\eta}_{i, t}\n  +\n  \\boldsymbol{\\varepsilon}_{i, t}\n  \\quad\n  \\mathrm{with}\n  \\quad\n  \\boldsymbol{\\varepsilon}_{i, t}\n  \\sim\n  \\mathcal{N}\n  \\left(\n  \\mathbf{0},\n  \\boldsymbol{\\Theta}\n  \\right)\n\\end{equation}\\]\nwhere \\(\\mathbf{y}_{i, t}\\), \\(\\boldsymbol{\\eta}_{i, t}\\), and \\(\\boldsymbol{\\varepsilon}_{i, t}\\) are random variables and \\(\\boldsymbol{\\nu}\\), \\(\\boldsymbol{\\Lambda}\\), and \\(\\boldsymbol{\\Theta}\\) are model parameters. \\(\\mathbf{y}_{i, t}\\) is a vector of observed random variables at time \\(t\\) and individual \\(i\\), \\(\\boldsymbol{\\eta}_{i, t}\\) is a vector of latent random variables at time \\(t\\) and individual \\(i\\), and \\(\\boldsymbol{\\varepsilon}_{i, t}\\) is a vector of random measurement errors at time \\(t\\) and individual \\(i\\), while \\(\\boldsymbol{\\nu}\\) is a vector of intercept, \\(\\boldsymbol{\\Lambda}\\) is a matrix of factor loadings, and \\(\\boldsymbol{\\Theta}\\) is the covariance matrix of \\(\\boldsymbol{\\varepsilon}\\).\nThe dynamic structure is given by\n\\[\\begin{equation}\n  \\mathrm{d} \\boldsymbol{\\eta}_{i, t}\n  =\n  \\boldsymbol{\\Phi}\n  \\left(\n  \\boldsymbol{\\mu}\n  -\n  \\boldsymbol{\\eta}_{i, t}\n  \\right)\n  \\mathrm{d}t\n  +\n  \\boldsymbol{\\Sigma}^{\\frac{1}{2}}\n  \\mathrm{d}\n  \\mathbf{W}_{i, t}\n\\end{equation}\\]\nwhere \\(\\boldsymbol{\\mu}\\) is the long-term mean or equilibrium level, \\(\\boldsymbol{\\Phi}\\) is the rate of mean reversion, determining how quickly the variable returns to its mean, \\(\\boldsymbol{\\Sigma}\\) is the matrix of volatility or randomness in the process, and \\(\\mathrm{d}\\boldsymbol{W}\\) is a Wiener process or Brownian motion, which represents random fluctuations."
  },
  {
    "objectID": ".setup/quarto/examples/ou.html#data-generation",
    "href": ".setup/quarto/examples/ou.html#data-generation",
    "title": "The Ornstein–Uhlenbeck Model",
    "section": "Data Generation",
    "text": "Data Generation\n\nNotation\nLet \\(t = 1000\\) be the number of time points and \\(n = 5\\) be the number of individuals.\nLet the measurement model intecept vector \\(\\boldsymbol{\\nu}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\nu}\n=\n\\left(\n\\begin{array}{c}\n  0 \\\\\n  0 \\\\\n  0 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the factor loadings matrix \\(\\boldsymbol{\\Lambda}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\Lambda}\n=\n\\left(\n\\begin{array}{ccc}\n  1 & 0 & 0 \\\\\n  0 & 1 & 0 \\\\\n  0 & 0 & 1 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the measurement error covariance matrix \\(\\boldsymbol{\\Theta}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\Theta}\n=\n\\left(\n\\begin{array}{ccc}\n  0.5 & 0 & 0 \\\\\n  0 & 0.5 & 0 \\\\\n  0 & 0 & 0.5 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the initial condition \\(\\boldsymbol{\\eta}_{0}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\eta}_{0} \\sim \\mathcal{N} \\left( \\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}, \\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0} \\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\mu}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{c}\n  0 \\\\\n  0 \\\\\n  0 \\\\\n\\end{array}\n\\right)\n\\end{equation}\\]\n\\[\\begin{equation}\n\\boldsymbol{\\Sigma}_{\\boldsymbol{\\eta} \\mid 0}\n=\n\\left(\n\\begin{array}{ccc}\n  1 & 0 & 0 \\\\\n  0 & 1 & 0 \\\\\n  0 & 0 & 1 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the long-term mean vector \\(\\boldsymbol{\\mu}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\mu}\n=\n\\left(\n\\begin{array}{c}\n  0 \\\\\n  0 \\\\\n  0 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the rate of mean reversion matrix \\(\\boldsymbol{\\Phi}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\Phi}\n=\n\\left(\n\\begin{array}{ccc}\n  0.357 & 0 & 0 \\\\\n  -0.771 & 0.511 & 0 \\\\\n  0.45 & -0.729 & 0.693 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet the dynamic process noise covariance matrix \\(\\boldsymbol{\\Sigma}\\) be given by\n\\[\\begin{equation}\n\\boldsymbol{\\Sigma}\n=\n\\left(\n\\begin{array}{ccc}\n  1 & 0 & 0 \\\\\n  0 & 1 & 0 \\\\\n  0 & 0 & 1 \\\\\n\\end{array}\n\\right) .\n\\end{equation}\\]\nLet \\(\\Delta_{t} = 0.1\\).\n\n\nR Function Arguments\n\nn\n\n[1] 5\n\ntime\n\n[1] 1000\n\ndelta_t\n\n[1] 0.1\n\nmu0\n\n[1] 0 0 0\n\nsigma0\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\nmu\n\n[1] 0 0 0\n\nphi\n\n       [,1]   [,2]  [,3]\n[1,]  0.357  0.000 0.000\n[2,] -0.771  0.511 0.000\n[3,]  0.450 -0.729 0.693\n\nsigma\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\nnu\n\n[1] 0 0 0\n\nlambda\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\ntheta\n\n     [,1] [,2] [,3]\n[1,]  0.5  0.0  0.0\n[2,]  0.0  0.5  0.0\n[3,]  0.0  0.0  0.5\n\n\n\n\nUsing the SimSSMOUFixed Function from the simStateSpace Package to Simulate Data\n\nlibrary(simStateSpace)\nsim &lt;- SimSSMOUFixed(\n  n = n,\n  mu0 = mu0,\n  sigma0 = sigma0,\n  mu = mu,\n  phi = phi,\n  sigma = sigma,\n  nu = nu,\n  lambda = lambda,\n  theta = theta,\n  delta_t = delta_t,\n  time = time,\n  burn_in = 0\n)\ndata &lt;- as.data.frame(sim)\nhead(data)\n\n  id time         y1        y2       y3\n1  1  0.0 -0.2452235 0.3791894 2.916196\n2  1  0.1 -0.6408937 1.7824870 1.400803\n3  1  0.2 -0.9755917 2.0512793 2.498214\n4  1  0.3 -2.5120801 0.7969752 2.234649\n5  1  0.4 -1.7204259 0.6404276 2.053562\n6  1  0.5  0.4753620 1.3252011 2.114403\n\nplot(sim)"
  },
  {
    "objectID": ".setup/quarto/examples/ou.html#model-fitting",
    "href": ".setup/quarto/examples/ou.html#model-fitting",
    "title": "The Ornstein–Uhlenbeck Model",
    "section": "Model Fitting",
    "text": "Model Fitting\n\nPrepare Data\n\ndynr_data &lt;- dynr::dynr.data(\n  dataframe = data,\n  id = \"id\",\n  time = \"time\",\n  observed = c(\"y1\", \"y2\", \"y3\")\n)\n\n\n\nPrepare Initial Condition\n\ndynr_initial &lt;- dynr::prep.initial(\n  values.inistate = mu0,\n  params.inistate = c(\"mu0_1\", \"mu0_2\", \"mu0_3\"),\n  values.inicov = sigma0,\n  params.inicov = matrix(\n    data = c(\n      \"sigma0_11\", \"sigma0_12\", \"sigma0_13\",\n      \"sigma0_12\", \"sigma0_22\", \"sigma0_23\",\n      \"sigma0_13\", \"sigma0_23\", \"sigma0_33\"\n    ),\n    nrow = 3\n  )\n)\n\n\n\nPrepare Measurement Model\n\ndynr_measurement &lt;- dynr::prep.measurement(\n  values.load = diag(3),\n  params.load = matrix(data = \"fixed\", nrow = 3, ncol = 3),\n  state.names = c(\"eta_1\", \"eta_2\", \"eta_3\"),\n  obs.names = c(\"y1\", \"y2\", \"y3\")\n)\n\n\n\nPrepare Dynamic Process\n\ndynr_dynamics &lt;- dynr::prep.formulaDynamics(\n  formula = list(\n    eta_1 ~ phi_11 * (mu_1 - eta_1) + phi_12 * (mu_2 - eta_2) + phi_13 * (mu_3 - eta_3),\n    eta_2 ~ phi_21 * (mu_1 - eta_1) + phi_22 * (mu_2 - eta_2) + phi_23 * (mu_3 - eta_3),\n    eta_3 ~ phi_31 * (mu_1 - eta_1) + phi_32 * (mu_2 - eta_2) + phi_33 * (mu_3 - eta_3)\n  ),\n  startval = c(\n    mu_1 = 0, mu_2 = 0, mu_3 = 0,\n    phi_11 = 0, phi_12 = 0, phi_13 = 0,\n    phi_21 = 0, phi_22 = 0, phi_23 = 0,\n    phi_31 = 0, phi_32 = 0, phi_33 = 0\n  ),\n  isContinuousTime = TRUE\n)\n\n\n\nPrepare Process Noise\n\ndynr_noise &lt;- dynr::prep.noise(\n  values.latent = sigma,\n  params.latent = matrix(\n    data = c(\n      \"sigma_11\", \"sigma_12\", \"sigma_13\",\n      \"sigma_12\", \"sigma_22\", \"sigma_23\",\n      \"sigma_13\", \"sigma_23\", \"sigma_33\"\n    ),\n    nrow = 3\n  ),\n  values.observed = theta,\n  params.observed = matrix(\n    data = c(\n      \"theta_11\", \"fixed\", \"fixed\",\n      \"fixed\", \"theta_22\", \"fixed\",\n      \"fixed\", \"fixed\", \"theta_33\"\n    ),\n    nrow = 3\n  )\n)\n\n\n\nPrepare the Model\n\nmodel &lt;- dynr::dynr.model(\n  data = dynr_data,\n  initial = dynr_initial,\n  measurement = dynr_measurement,\n  dynamics = dynr_dynamics,\n  noise = dynr_noise,\n  outfile = \"ou.c\"\n)\n\nAdd lower and upper bounds to aid in the optimization.\n\nmodel$lb[\n  c(\n    \"phi_11\",\n    \"phi_12\",\n    \"phi_13\",\n    \"phi_21\",\n    \"phi_22\",\n    \"phi_23\",\n    \"phi_31\",\n    \"phi_32\",\n    \"phi_33\"\n  )\n] &lt;- -1.5\nmodel$ub[\n  c(\n    \"phi_11\",\n    \"phi_12\",\n    \"phi_13\",\n    \"phi_21\",\n    \"phi_22\",\n    \"phi_23\",\n    \"phi_31\",\n    \"phi_32\",\n    \"phi_33\"\n  )\n] &lt;- +1.5\nmodel$lb[\n  c(\n    \"sigma_11\",\n    \"sigma_22\",\n    \"sigma_33\",\n    \"theta_11\",\n    \"theta_22\",\n    \"theta_33\"\n  )\n] &lt;- .Machine$double.xmin\n\n\n\n\n\n\n\n\nFit the Model\n\nresults &lt;- dynr::dynr.cook(\n  model,\n  debug_flag = TRUE,\n  verbose = FALSE\n)\n\n[1] \"Get ready!!!!\"\nusing C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’\nOptimization function called.\nStarting Hessian calculation ...\nFinished Hessian calculation.\nOriginal exit flag:  3 \nModified exit flag:  3 \nOptimization terminated successfully: ftol_rel or ftol_abs was reached. \nOriginal fitted parameters:  0.06170586 0.1539591 0.1503428 0.447179 \n0.006878862 -0.02237471 -0.7084987 0.4865505 -0.02687934 0.4085459 -0.6572728 \n0.6798754 0.08775009 -0.02513747 -0.09408974 0.07669431 -0.0564341 -0.07153665 \n-0.7087437 -0.7459179 -0.7041478 0.8982052 0.1539088 0.6066994 -0.3401838 \n0.04180542 -1.211941 0.6758595 -0.09317225 -0.4372129 \n\nTransformed fitted parameters:  0.06170586 0.1539591 0.1503428 0.447179 \n0.006878862 -0.02237471 -0.7084987 0.4865505 -0.02687934 0.4085459 -0.6572728 \n0.6798754 1.091715 -0.02744295 -0.1027192 1.080402 -0.05835047 0.9440657 \n0.4922622 0.4742987 0.4945298 0.8982052 0.1539088 0.6066994 0.7116395 \n0.02975039 -0.8624653 1.966966 -0.2192064 1.708156 \n\nDoing end processing\nSuccessful trial\nTotal Time: 3.925899 \nBackend Time: 3.917677"
  },
  {
    "objectID": ".setup/quarto/examples/ou.html#summary",
    "href": ".setup/quarto/examples/ou.html#summary",
    "title": "The Ornstein–Uhlenbeck Model",
    "section": "Summary",
    "text": "Summary\n\nsummary(results)\n\nCoefficients:\n           Estimate Std. Error t value  ci.lower  ci.upper Pr(&gt;|t|)    \nmu_1       0.061706   0.107721   0.573 -0.149424  0.272836   0.2834    \nmu_2       0.153959   0.191496   0.804 -0.221366  0.529285   0.2107    \nmu_3       0.150343   0.146024   1.030 -0.135859  0.436544   0.1516    \nphi_11     0.447179   0.081386   5.495  0.287665  0.606693   &lt;2e-16 ***\nphi_12     0.006879   0.061876   0.111 -0.114397  0.128154   0.4557    \nphi_13    -0.022375   0.058038  -0.386 -0.136127  0.091377   0.3499    \nphi_21    -0.708499   0.076857  -9.218 -0.859136 -0.557862   &lt;2e-16 ***\nphi_22     0.486550   0.062938   7.731  0.363194  0.609907   &lt;2e-16 ***\nphi_23    -0.026879   0.058559  -0.459 -0.141653  0.087894   0.3231    \nphi_31     0.408546   0.071559   5.709  0.268293  0.548799   &lt;2e-16 ***\nphi_32    -0.657273   0.057579 -11.415 -0.770126 -0.544420   &lt;2e-16 ***\nphi_33     0.679875   0.056593  12.013  0.568955  0.790796   &lt;2e-16 ***\nsigma_11   1.091715   0.094471  11.556  0.906556  1.276874   &lt;2e-16 ***\nsigma_12  -0.027443   0.056632  -0.485 -0.138440  0.083554   0.3140    \nsigma_13  -0.102719   0.053361  -1.925 -0.207305  0.001866   0.0271 *  \nsigma_22   1.080402   0.085756  12.599  0.912322  1.248481   &lt;2e-16 ***\nsigma_23  -0.058350   0.051216  -1.139 -0.158733  0.042032   0.1273    \nsigma_33   0.944066   0.076705  12.308  0.793727  1.094404   &lt;2e-16 ***\ntheta_11   0.492262   0.013856  35.526  0.465104  0.519420   &lt;2e-16 ***\ntheta_22   0.474299   0.013247  35.804  0.448335  0.500263   &lt;2e-16 ***\ntheta_33   0.494530   0.013363  37.008  0.468339  0.520720   &lt;2e-16 ***\nmu0_1      0.898205   0.413539   2.172  0.087684  1.708727   0.0150 *  \nmu0_2      0.153909   0.649164   0.237 -1.118430  1.426248   0.4063    \nmu0_3      0.606699   0.595128   1.019 -0.559729  1.773128   0.1540    \nsigma0_11  0.711640   0.583317   1.220 -0.431642  1.854921   0.1113    \nsigma0_12  0.029750   0.614325   0.048 -1.174305  1.233806   0.4807    \nsigma0_13 -0.862465   0.674820  -1.278 -2.185088  0.460157   0.1006    \nsigma0_22  1.966966   1.353099   1.454 -0.685060  4.618992   0.0730 .  \nsigma0_23 -0.219206   0.906841  -0.242 -1.996583  1.558170   0.4045    \nsigma0_33  1.708156   1.195713   1.429 -0.635399  4.051710   0.0766 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n-2 log-likelihood value at convergence = 37920.34\nAIC = 37980.34\nBIC = 38175.86\n\n\n\n\n[1] 0.8982052 0.1539088 0.6066994\n\n\n\nParameter Estimates\n\nmu_hat\n\n[1] 0.06170586 0.15395914 0.15034276\n\nphi_hat\n\n           [,1]         [,2]        [,3]\n[1,]  0.4471790  0.006878862 -0.02237471\n[2,] -0.7084987  0.486550483 -0.02687934\n[3,]  0.4085459 -0.657272797  0.67987544\n\nsigma_hat\n\n            [,1]        [,2]        [,3]\n[1,]  1.09171525 -0.02744295 -0.10271920\n[2,] -0.02744295  1.08040181 -0.05835047\n[3,] -0.10271920 -0.05835047  0.94406565\n\nmu0_hat\n\n[1] 0.8982052 0.1539088 0.6066994\n\nsigma0_hat\n\n            [,1]        [,2]       [,3]\n[1,]  0.71163955  0.02975039 -0.8624653\n[2,]  0.02975039  1.96696553 -0.2192064\n[3,] -0.86246527 -0.21920645  1.7081557\n\nbeta_var1_hat &lt;- as.matrix(\n  Matrix::expm(-1 * phi_hat)\n)\nbeta_var1_hat\n\n            [,1]          [,2]       [,3]\n[1,]  0.63622735 -1.550278e-05 0.01272285\n[2,]  0.44143560  6.193595e-01 0.01967659\n[3,] -0.09708627  3.685841e-01 0.50994073"
  },
  {
    "objectID": ".setup/quarto/references/references.html",
    "href": ".setup/quarto/references/references.html",
    "title": "References",
    "section": "",
    "text": "Boettiger, C., & Eddelbuettel, D. (2017). An introduction to\nRocker: Docker containers for R. The R\nJournal, 9(2), 527. https://doi.org/10.32614/rj-2017-065\n\n\nNüst, D., Eddelbuettel, D., Bennett, D., Cannoodt, R., Clark, D.,\nDar’oczi, G., Edmondson, M., Fay, C., Hughes, E., Kjeldgaard, L., Lopp,\nS., Marwick, B., Nolis, H., Nolis, J., Ooi, H., Ram, K., Ross, N.,\nShepherd, L., S’olymos, P., … Xiao, N. (2020). The\nRockerverse: Packages and applications for containerisation\nwith R. The R Journal, 12(1), 437. https://doi.org/10.32614/rj-2020-007\n\n\nOu, L., Hunter, M. D., & Chow, S.-M. (2019). What’s for dynr: A package for linear and nonlinear dynamic\nmodeling in R. The R Journal, 11(1), 91.\nhttps://doi.org/10.32614/rj-2019-012"
  },
  {
    "objectID": ".setup/quarto/session/session.html#session",
    "href": ".setup/quarto/session/session.html#session",
    "title": "Appendix A — Website Build Session",
    "section": "Session",
    "text": "Session\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Etc/UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.4 compiler_4.3.2    fastmap_1.1.1     cli_3.6.2.9000   \n [5] tools_4.3.2       htmltools_0.5.7   yaml_2.3.8        rmarkdown_2.25   \n [9] knitr_1.45        jsonlite_1.8.8    xfun_0.41         digest_0.6.34    \n[13] rlang_1.1.3       evaluate_0.23    \n\n\n\n\n/srv/build/CONTAINER_RELEASE: ecd2846ab2cf30c5c95ece337e788619c6e9e444\n/srv/build/CONTAINER_RELEASE_MSG: This release is based on commit ecd2846ab2cf30c5c95ece337e788619c6e9e444.\n/srv/build/DOCKER_HUB_CONTAINER: docs\n/srv/build/DOCKER_HUB_USERNAME: ijapesigan\n/srv/build/GIT_HUB_REPO: docker-docs\n/srv/build/GIT_HUB_USERNAME: ijapesigan"
  }
]